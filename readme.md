# 스마트 쉼터 경유 네비 PoC (Seongdong)

성동구 보행 약자(고령자·휠체어 사용자)를 위해,  
**기온 상황에 따라 ‘최단거리’가 아닌 ‘머물 수 있는 장소(쉼터)’를 기준으로 안내하는**
지도 기반 내비게이션 Proof of Concept 프로젝트입니다.

---

## 1. 프로젝트 목적

기존 내비게이션은 항상 “최단거리”를 기준으로 경로를 제시합니다.  
본 PoC는 폭염·한파 상황에서 **보행 약자가 실제로 필요로 하는 요소(쉼터)**를 고려하여,

- 한파일 때는 쉼터를 경유하도록 유도하고
- 무더위일 때는 쉼터의 의미를 UI로 강조하며
- 화장실·충전소는 경로가 아닌 **주변 정보**로 제공

하는 것을 목표로 합니다.

---

## 2. 핵심 컨셉

- ❌ 항상 최단거리
- ✅ 상황(기온)에 따라 **머물 수 있는 장소 중심 안내**

화장실·충전소는 “도착해야 하는 목적지”가 아니라  
→ **지금 내 위치에서 바로 찾는 정보**로 제공합니다.

---

## 3. 주요 기능

### 지도 & 기본
- Naver Maps JS SDK 기반 지도 초기화
- 지도 클릭 / ESC → 인포윈도우 닫기
- Shift + P 좌표 따기 모드(디버그용)

### 출발 / 도착 / 경로
- 출발지
  - 주소 지오코딩
  - “집” 버튼으로 빠른 세팅
- 도착지
  - 키워드 매핑 우선(성동구청, 한양대병원 등)
  - 실패 시 주소 지오코딩
- 경로
  - Tmap 보행자 경로 API (프록시 서버 경유)
  - 실패 시 직선 fallback 표시

### 내 현재 위치
- 출발지와 분리된 **독립 마커/상태**
- “내 위치” 표시만 수행 (출발 설정 X)

### 데이터 레이어(JSON)
- 스마트 쉼터
- 한파·무더위 쉼터
- ♿ 전동보장구 급속 충전소
- 🚻 공공화장실  
→ 모두 JSON 기반 로드 및 마커 표시

---

## 4. 모드 개념 (최종 3모드)

### NORMAL (일반)
- 최단 도보 경로
- 쉼터는 정보 표시만

### COLD (한파)
- 쉼터 1곳 경유
- 자동 추천 / 수동 선택 가능
- 데모 시나리오:
  - “한파 모드 + 성동구청” → 왕십리역 4번 출구 고정 경유

### HEAT (무더위)
- 경로 정책은 NORMAL과 동일(최단)
- 대신 쉼터 UI/라벨을 **“무더위 쉼터” 의미로 강조**
- “무더위” 텍스트는 HEAT에서만 등장

---

## 5. 근처 안내 기능 (정책 확정)

- “근처 ♿ 충전소 / 근처 🚻 화장실” 버튼
- 경로 안내 없음
- 동작:
  1. 내 위치 표시
  2. 가장 가까운 시설 탐색
  3. 해당 위치로 pan 이동
  4. 인포윈도우로 이름/주소/거리 표시

---

## 6. UI 특징

- 100vh 고정 레이아웃 → 화면 반토막 이슈 방지
- 시니어 친화 UI
  - 큰 폰트
  - 큰 터치 영역
  - 단순한 버튼 구조
- 2×2 레이어 토글 버튼
  - 스마트 쉼터
  - 한파·무더위 쉼터
  - 공공화장실
  - 휠체어 충전소

---

## 7. 파일 구조

/
├─ index.html
│ └─ 좌측 UI 패널 + 지도 영역 + 날씨 위젯 DOM
├─ style.css
│ └─ 100vh 고정 레이아웃 + 시니어 친화 UI
├─ main.js
│ └─ 지도 초기화 / 마커 / 경로 / 모드 / 근처 안내 
├─ shelters.seongdong.json
├─ seongdong_mobility_fast_charging_stations.json
└─ seongdong_public_toilets.json


---

## 8. 실행 방법

### 1) 프론트
- Live Server 등 **정적 서버로 실행 권장**
- `file://` 직접 실행은 JSON fetch 문제로 비권장

### 2) 프록시 서버 (권장)
- API 서버: `http://localhost:4000`
- 엔드포인트: `/api/tmap/pedestrian`
- 프록시 미실행 시:
  - Tmap 경로 호출 실패
  - 직선 fallback만 표시됨

---

## 9. 현재 남은 작업

1. **2×2 레이어 토글 버튼 동작 연결**
   - 마커 배열을 `setMap(null / map)`으로 ON/OFF
2. (선택) HEAT 모드 자동 경유 정책 확장
3. `main.js` 코드 분리 리팩토링
   - state / map / layer / route / ui 단위로 분리 권장

---

## 10. 앱(App)으로 전환 시 고려 사항

### 위치 정보
- GPS 권한 처리(정확도/거부/실패 UX)
- 위치 오차 반경 표시
- 배터리 소모 고려

### 지도/경로 SDK
- WebView 유지 vs 네이티브(React Native / Flutter) 전환
- 지도·경로 API 이원화 최소화 권장

### 보안
- API Key 하드코딩 금지
- 프록시 서버 유지
- 도메인/번들 ID 제한

### 데이터 관리
- 쉼터/시설 JSON 캐싱
- 갱신 주기/기준일 명시
- 오프라인 대응

### 접근성
- 큰 글씨/큰 버튼 유지
- 색상만으로 상태 구분 금지
- 음성 안내(TTS), 고대비 모드 고려

### 법·정책
- “참고 정보” 고지
- 데이터 출처 및 갱신일 명시
- 안전/책임 면책 문구 필요

---

## 11. 데모 시나리오

1. Shift + H로 모드 전환
2. COLD 모드 + 성동구청 → 쉼터 경유 확인
3. 근처 충전소 / 화장실 버튼으로 즉시 정보 제공
